---
import chevron from '../assets/chevron-right.svg';
const { chapter, lesson, courseIndex, title } = Astro.props;
---
<style>
  *:focus {
    border-radius: 4px;
    box-shadow: rgb(0, 82, 255) 0px 0px 12px, rgb(0, 82, 255) 0px 0px 0px 1px;
    outline: 1px;
    transition: box-shadow 0.1s ease-in-out 0s;
  }

  .sidebar {
    z-index: 3;
    font-weight: 300;
    flex-shrink: 0;
    width: 275px;
    background: white;
    box-shadow: rgb(0 0 0 / 12%) 0px 0px 4px 0px, rgb(0 0 0 / 24%) 0px 4px 4px 0px;
  }

  .sidebar > ul:first-of-type {
    margin-top: 20px;
  }

  .sidebar > ul {
    position: relative;
  }

  ul details {
    position: relative;
  }

  summary:focus{
    position: relative;
    z-index: 9;
  }

  ul {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  li {
    padding: 12px 18px;
  }


  .sidebar-link {
    display: block;
    text-decoration: none;
    color: black;
    /* color: rgb(0, 82, 255); */
  }

  .sidebar-link:visited {
    color: black;
  }

  .sidebar-link:hover,
  .sidebar-link:focus{
    color: rgb(0, 82, 255);
    text-decoration: underline;
    background-color: #f5f5f5;
  }


  .sidebar-link:hover {
    background-color: #f5f5f5;
  }

  .active-chapter,
  .current {
    border-radius: 4px;
    font-weight: 500;
    background-color: #f5f5f5;
    border-left: solid 5px rgb(0, 82, 255);
  }

  summary {
    list-style: none;
  }
  summary:hover,
  summary:focus {
    cursor: pointer;
    background-color: #f5f5f5;
  }

  summary li {
    display: flex;
    align-items: center;
  }

  details .chevron {
    margin-right: 12px;
    transition: transform 0.1s ease-in-out;
  }
  details[open] .chevron {
    transform: rotate(90deg);
  }

  .active-chapter .chevron {
    margin-left: -5px;
  }

  .lessons {
    list-style: none;
    counter-reset: my-awesome-counter;
  }
  .lessons li {
    counter-increment: my-awesome-counter;
    padding-left: 50px;
  }
  .lessons li::before {
    content: counter(my-awesome-counter) ". ";
    margin-right: 8px;
    font-weight: bold;
  }

  .course-title {
    text-align: center;
    font-weight: 500;
    padding-left: 20px;
    padding-right: 20px;
    margin-top: 20px;
    margin-bottom: 20px;
  }

  .current-lesson {
    font-weight: 500;
  }
</style>
<div class="sidebar">
  <p class="course-title">{title}</p>
  {courseIndex.map((c, i) => {
    return (
      <ul>
        <details open={parseInt(chapter) === i}>
          <summary>
            <li class={parseInt(chapter) === i ? 'active-chapter' : ''}>
              <img class="chevron" src={chevron} alt=""/>
              {c.title}
            </li>
          </summary>
          <ul class="lessons">
            {c.lessons.map((l, j) => {
              return parseInt(lesson) === j && parseInt(chapter) === i 
                ? (<li class="current-lesson">{l.title}</li>)
                : (<a class="sidebar-link" href={`/sw/chapter/${i}/lesson/${j}`}>
                  <li class={parseInt(lesson) === j ? 'active-lesson' : ''}>{l.title}</li>
                </a>)
            
              })
            }
          </ul>
        </details>
      </ul>
    )
  })}
</div>